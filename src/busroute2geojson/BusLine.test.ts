import { BusLine } from './BusLine';

describe('serialize', (): void => {
    test('should generate GeoJSON string conrrectly.', (): void => {
        const jsonStr =
            '{"status":"OK","stations":[' +
            '{"sid":"186423","name":"\\u897f\\u5927\\u5bfa\\u4e2d\\u4e09\\u4e01\\u76ee","type":"1","x":"7317572","y":"3332511"},' +
            '{"sid":"186424","name":"\\u6d5c","type":"1","x":"7317691","y":"3332718"},' +
            '{"sid":"186439","name":"\\u7d3a\\u6d66\\uff08\\u725b\\u7a93\\u652f\\u6240\\u524d\\uff09","type":"1","x":"7320159","y":"3333485"},' +
            '{"sid":"186440","name":"\\u702c\\u6238\\u5185\\u8b66\\u5bdf\\u7f72\\u524d","type":"1","x":"7320301","y":"3333506"},' +
            '{"sid":"186441","name":"\\u672c\\u84ee\\u5bfa\\u4e0b","type":"1","x":"7320545","y":"3333606"},' +
            '{"sid":"186442","name":"\\u725b\\u7a93","type":"1","x":"7320591","y":"3333645"},' +
            '{"sid":"186443","name":"\\u65ed\\u5ddd\\u8358\\u5409\\u4e95\\u5ddd\\u30ad\\u30e3\\u30f3\\u30d1\\u30b9\\u6b63\\u9580\\u524d","type":"1","x":"7317793","y":"3332770"},' +
            '{"sid":"186444","name":"\\u6771\\u90e8\\u30af\\u30ea\\u30fc\\u30f3\\u30bb\\u30f3\\u30bf\\u30fc\\u524d","type":"1","x":"7317966","y":"3332694"},' +
            '{"sid":"186445","name":"\\u897f\\u5927\\u5bfa\\u65b0\\u5730","type":"1","x":"7318034","y":"3332626"},' +
            '{"sid":"186446","name":"\\u65b0\\u958b\\u56e3\\u5730\\u524d","type":"1","x":"7317967","y":"3332535"},' +
            '{"sid":"186447","name":"\\u5c04\\u8d8a","type":"1","x":"7318023","y":"3332442"},' +
            '{"sid":"186448","name":"\\u4e0a\\u5bfa\\u5165\\u53e3","type":"1","x":"7318106","y":"3332387"},' +
            '{"sid":"186449","name":"\\u798f\\u5c71\\u6a4b","type":"1","x":"7318170","y":"3332294"},' +
            '{"sid":"186450","name":"\\u5927\\u7aaa","type":"1","x":"7318725","y":"3332336"},' +
            '{"sid":"186451","name":"\\u9091\\u4e45\\u99c5\\u5165\\u53e3","type":"1","x":"7318859","y":"3332212"},' +
            '{"sid":"186452","name":"\\u9091\\u4e45\\u99c5","type":17,"x":"7318858","y":"3332125"},' +
            '{"sid":"186453","name":"\\u5343\\u753a\\u897f","type":"1","x":"7319083","y":"3332258"},' +
            '{"sid":"186454","name":"\\u5343\\u753a","type":"1","x":"7319207","y":"3332286"},' +
            '{"sid":"186455","name":"\\u5343\\u753a\\u6a4b","type":"1","x":"7319403","y":"3332332"},' +
            '{"sid":"186456","name":"\\u5922\\u4e8c\\u751f\\u5bb6\\u524d\\u30fb\\u5c71\\u7530\\u5165\\u53e3","type":"1","x":"7319515","y":"3332362"},' +
            '{"sid":"186457","name":"\\u5c0f\\u6d25","type":"1","x":"7319809","y":"3332841"},' +
            '{"sid":"186458","name":"\\u6d25\\u884c","type":"1","x":"7319910","y":"3332975"},' +
            '{"sid":"186459","name":"\\u5965\\u6d66","type":"1","x":"7319877","y":"3333093"},' +
            '{"sid":"186460","name":"\\u5e2b\\u697d\\u5165\\u53e3","type":"1","x":"7320011","y":"3333281"},' +
            '{"sid":"186461","name":"\\u7d3a\\u6d66\\u53e3","type":"1","x":"7320101","y":"3333505"},' +
            '{"sid":"189470","name":"\\u30aa\\u30ea\\u30fc\\u30d6\\u5712\\u5165\\u53e3","type":"1","x":"7320506","y":"3333569"},' +
            '{"sid":"189471","name":"\\u7dbe\\u6d66","type":"1","x":"7320385","y":"3333552"},' +
            '{"sid":"189472","name":"\\u725b\\u7a93\\u4e2d\\u5b66\\u6821\\u524d","type":"1","x":"7320208","y":"3333482"},' +
            '{"sid":"189489","name":"\\u65ed\\u5ddd\\u8358\\u5409\\u4e95\\u5ddd\\u30ad\\u30e3\\u30f3\\u30d1\\u30b9\\u524d","type":"1","x":"7317748","y":"3332772"},' +
            '{"sid":"189490","name":"\\u89b3\\u97f3\\u9662\\u5165\\u53e3","type":"1","x":"7317569","y":"3332565"},' +
            '{"sid":"189493","name":"\\u897f\\u5927\\u5bfa\\u3075\\u308c\\u3042\\u3044\\u30bb\\u30f3\\u30bf\\u30fc","type":"1","x":"7317550","y":"3332471"},' +
            '{"sid":"189494","name":"\\u897f\\u5927\\u5bfa\\u30d0\\u30b9\\u30bb\\u30f3\\u30bf\\u30fc","type":"1","x":"7317431","y":"3332473"},' +
            '{"sid":"189507","name":"\\u5965\\u6d66\\u4e0b","type":"1","x":"7319885","y":"3333174"},' +
            '{"sid":"189508","name":"\\u6a2a\\u5c3e\\u5165\\u53e3","type":"1","x":"7319693","y":"3332750"},' +
            '{"sid":"189509","name":"\\u672c\\u5e84\\u5357","type":"1","x":"7319660","y":"3332476"},' +
            '{"sid":"189511","name":"\\u702c\\u6238\\u5185\\u5e02\\u6c11\\u75c5\\u9662","type":"1","x":"7319073","y":"3332200"},' +
            '{"sid":"189512","name":"\\u5c3e\\u5f35","type":"1","x":"7318972","y":"3332227"},' +
            '{"sid":"189513","name":"\\u702c\\u6238\\u5185\\u5e02\\u5f79\\u6240\\u524d","type":"1","x":"7318881","y":"3332207"},' +
            '{"sid":"189514","name":"\\u8c4a\\u5b89","type":"1","x":"7318815","y":"3332299"},' +
            '{"sid":"189515","name":"\\u5927\\u7aaa\\u897f","type":"1","x":"7318659","y":"3332322"},' +
            '{"sid":"189516","name":"\\u6c96\\u7530","type":"1","x":"7318568","y":"3332305"},' +
            '{"sid":"189517","name":"\\u5927\\u5bcc\\u6771","type":17,"x":"7318356","y":"3332267"},' +
            '{"sid":"189518","name":"\\u5927\\u5bcc","type":"1","x":"7318265","y":"3332249"},' +
            '{"sid":"189519","name":"\\u5ddd\\u53e3","type":"1","x":"7317915","y":"3332585"},' +
            '{"sid":"189520","name":"\\u5065\\u5e78\\u30d7\\u30e9\\u30b6\\u524d","type":"1","x":"7317866","y":"3332738"},' +
            '{"sid":"189544","name":"\\u4f50\\u4e95\\u7530","type":"1","x":"7319593","y":"3332364"}],' +
            '"routes":["iworE}v`qXMgg@fJdB~@F~KQTPFz@",' +
            '"mgqrEynnqX}J}AGlA",' +
            '"mgqrEynnqXdPkyA~@{GdCsK?ePT_J[cSnH?rAPdEtAv@F~BY`JiCfFeBhBa@rT`@nJQdCQ`Ds@h@Yp@{@`HePdEmIlLkSp@cAnBoBv@YZ?zR?rGnBjErDzLs@nBa@nB{@nFuEb@}ALmAGs@c@eB",' +
            '"kqjrE}{uqXGoBLi@dAmAnDyClC}AvDY`FcAv@YnFyC~KqCrCqCpBs@hBcAT?h@a@dCiGiDwBi@cAq@cDUmELqC`DoUTiCrAmErE{Kv@kDh@_JGkHh@aGb@oBrAwB~@{@~BcAdCoB`BoBh@Yq@wB",' +
            '"s|nrEyyaqXFzDMz@MPUF[Gi@{@Ls@h@mAv@mA",' +
            '"s|nrEyyaqX|h@kt@gWibAmA_C_AcAwDyCq@hKoBpNiBnFmAtAw@XoBwIsEaG{A{@aH_CsA{@wBqC_A}AaDmIaHsOeA}AsA{@sC{@mCi@{CmAi@mAc@_Cc@uEq@eEoBgFG_CZ_CnBsH`Hm|@xEci@ZuEFsDM}AUs@mAoBcKoFaBmAkGcDiBs@",' +
            '"{rqrEawlqXyKwBUFeAbAq@tA","{rqrEawlqXhDg\\\\v@mAlCcW"]}';
        const busLine = new BusLine('1904');
        busLine.initFromString(jsonStr);

        const lineColor = '#ff0000';
        const lineWeight = 5;
        const addBusStopPoints = false;
        const geoJsonString = busLine.getGeoJsonString(lineColor, lineWeight, addBusStopPoints);

        expect(geoJsonString).toBe(
            '{"type":"FeatureCollection","features":[' +
                '{"type":"Feature","properties":{"_color":"#ff0000","_opacity":1,"_weight":5},"geometry":{"type":"LineString","coordinates":[' +
                '[134.03007,34.65605],[134.03651,34.65612],[134.036,34.65432],[134.03596,34.654],[134.03605,34.65192],[134.03596,34.65181],[134.03566,34.65177]]}},' +
                '{"type":"Feature","properties":{"_color":"#ff0000","_opacity":1,"_weight":5},"geometry":{"type":"LineString","coordinates":[' +
                '[134.10045,34.66375],[134.10092,34.66566],[134.10053,34.6657]]}},' +
                '{"type":"Feature","properties":{"_color":"#ff0000","_opacity":1,"_weight":5},"geometry":{"type":"LineString","coordinates":[' +
                '[134.10045,34.66375],[134.11491,34.661],[134.11633,34.66068],[134.11835,34.66001],[134.1211,34.66001],[134.12286,34.6599],[134.12608,34.66004],' +
                '[134.12608,34.65852],[134.12599,34.6581],[134.12556,34.65711],[134.12552,34.65683],[134.12565,34.65619],[134.12634,34.65442],[134.12685,34.65326],' +
                '[134.12702,34.65273],[134.12685,34.64927],[134.12694,34.64743],[134.12703,34.64676],[134.12729,34.64595],[134.12742,34.64574],[134.12772,34.64549],' +
                '[134.13047,34.64404],[134.13214,34.64305],[134.1354,34.6409],[134.13574,34.64065],[134.1363,34.64009],[134.13643,34.63981],[134.13643,34.63967],' +
                '[134.13643,34.63649],[134.13587,34.63511],[134.13497,34.63409],[134.13523,34.63187],[134.1354,34.63131],[134.1357,34.63075],[134.13677,34.62955],' +
                '[134.13724,34.62937],[134.13763,34.6293],[134.13789,34.62934],[134.1384,34.62952]]}},' +
                '{"type":"Feature","properties":{"_color":"#ff0000","_opacity":1,"_weight":5},"geometry":{"type":"LineString","coordinates":[' +
                '[134.13839,34.6295],[134.13895,34.62954],[134.13916,34.62947],[134.13955,34.62912],[134.14032,34.62824],[134.14079,34.62753],[134.14092,34.62661],' +
                '[134.14126,34.62548],[134.14139,34.6252],[134.14216,34.624],[134.14289,34.62192],[134.14362,34.62118],[134.14388,34.62061],[134.14422,34.62008],' +
                '[134.14422,34.61997],[134.14439,34.61976],[134.14572,34.61909],[134.14632,34.61994],[134.14666,34.62015],[134.14748,34.6204],[134.14851,34.62051],' +
                '[134.14924,34.62044],[134.15284,34.61963],[134.15353,34.61952],[134.15456,34.6191],[134.15662,34.61804],[134.15748,34.61776],[134.15924,34.61755],' +
                '[134.16074,34.61759],[134.16203,34.61738],[134.16259,34.6172],[134.16319,34.61678],[134.16349,34.61646],[134.16383,34.61582],[134.16439,34.61515],' +
                '[134.16495,34.61466],[134.16508,34.61445],[134.16568,34.6147]]}},' +
                '{"type":"Feature","properties":{"_color":"#ff0000","_opacity":1,"_weight":5},"geometry":{"type":"LineString","coordinates":[' +
                '[134.03565,34.65178],[134.03471,34.65174],[134.03441,34.65181],[134.03432,34.65188],[134.03428,34.65199],[134.03432,34.65213],[134.03462,34.65234],' +
                '[134.03488,34.65227],[134.03527,34.65206],[134.03566,34.65178]]}},' +
                '{"type":"Feature","properties":{"_color":"#ff0000","_opacity":1,"_weight":5},"geometry":{"type":"LineString","coordinates":[' +
                '[134.03565,34.65178],[134.04419,34.64507],[134.05496,34.64895],[134.0556,34.64934],[134.05594,34.64966],[134.05671,34.65058],[134.05474,34.65083],' +
                '[134.05225,34.65139],[134.05105,34.65192],[134.05062,34.65231],[134.05049,34.65259],[134.05221,34.65315],[134.0535,34.65421],[134.0538,34.65467],' +
                '[134.05444,34.65612],[134.05474,34.65654],[134.05547,34.65714],[134.05594,34.65746],[134.05761,34.65827],[134.06027,34.65972],[134.06074,34.66007],' +
                '[134.06104,34.66049],[134.06134,34.66123],[134.06155,34.66194],[134.06194,34.66272],[134.06233,34.66293],[134.06297,34.66311],[134.06404,34.66329],' +
                '[134.06503,34.66354],[134.06619,34.6641],[134.06683,34.66414],[134.06747,34.664],[134.06901,34.66344],[134.07884,34.66199],[134.08558,34.6609],' +
                '[134.08665,34.66076],[134.08755,34.66072],[134.08802,34.66079],[134.08828,34.6609],[134.08884,34.66129],[134.09004,34.66323],[134.09043,34.66372],' +
                '[134.09125,34.66506],[134.09151,34.66559]]}},' +
                '{"type":"Feature","properties":{"_color":"#ff0000","_opacity":1,"_weight":5},"geometry":{"type":"LineString","coordinates":[' +
                '[134.09153,34.66558],[134.09213,34.66763],[134.09209,34.66774],[134.09175,34.66809],[134.09132,34.66834]]}},' +
                '{"type":"Feature","properties":{"_color":"#ff0000","_opacity":1,"_weight":5},"geometry":{"type":"LineString","coordinates":[' +
                '[134.09153,34.66558],[134.09621,34.66473],[134.0966,34.66445],[134.10046,34.66374]]}}]}'
        );
    });
});
